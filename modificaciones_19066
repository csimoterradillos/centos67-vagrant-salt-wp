1.-Desaparece add_epel_repo.sls
La imagen Vagrant original ya tiene instalado el repositorio EPEL
2.-Modificacion en mysql-formula
En la fase de validacion de SLS, siempre da este error:

Rendering SLS 'base:mysql.server' failed: Conflicting ID 'mysql_delete_anonymous_user_localhost.localdomain'

En diferentes foros, errores de este estilo generalmente se suelen asociar a bugs en el disenyo del fichero de estado.
Localizo esta entrada mysql_delete_anonymous en el fichero server.sls, concretamente asociado a un parrafo que parece
estar pensado para la configuracion en servidores Debian de mysql (en fic. original lineas 16-61):


{% if mysql_root_password %}
{% if os_family == 'Debian' %}
mysql_debconf_utils:
  pkg.installed:
    - name: {{ mysql.debconf_utils }}

mysql_debconf:
  debconf.set:
    - name: {{ mysql.server }}
    - data:
        '{{ mysql.server }}/root_password': {'type': 'password', 'value': '{{ mysql_root_password }}'}
        '{{ mysql.server }}/root_password_again': {'type': 'password', 'value': '{{ mysql_root_password }}'}
        '{{ mysql.server }}/start_on_boot': {'type': 'boolean', 'value': 'true'}
    - require_in:
      - pkg: {{ mysql.server }}
    - require:
      - pkg: mysql_debconf_utils
{% elif os_family == 'RedHat' or 'Suse' %}
mysql_root_password:
  cmd.run:
    - name: mysqladmin --user {{ mysql_root_user }} password '{{ mysql_root_password|replace("'", "'\"'\"'") }}'
    - unless: mysql --user {{ mysql_root_user }} --password='{{ mysql_root_password|replace("'", "'\"'\"'") }}' --execute="SELECT 1;"
    - require:
      - service: mysqld

{% for host in ['localhost', 'localhost.localdomain', salt['grains.get']('fqdn')] %}
mysql_delete_anonymous_user_{{ host }}:
  mysql_user:
    - absent
    - host: {{ host or "''" }}
    - name: ''
    - connection_host: '{{ mysql_host }}'
    - connection_user: '{{ mysql_salt_user }}'
    {% if mysql_salt_password %}
    - connection_pass: '{{ mysql_salt_password }}'
    {% endif %}
    - connection_charset: utf8
    - require:
      - service: mysqld
      - pkg: mysql_python
      {%- if (mysql_salt_user == mysql_root_user) and mysql_root_password %}
      - cmd: mysql_root_password
      {%- endif %}
{% endfor %}
{% endif %}
{% endif %}

Opto por eliminarlas, ya que no las vamos a utilizar al ser nuestro servidor destino un CentOS.

3.-Modificacion en top.sls
Decido, para las formulas apache y mysql utilizar sólo los modulos que presumiblemente vayamos a utilizar, para evitar en la medida de lo posible errores como el expuesto en el apartado 2.-

4.- Modificaciones menores en ficheros sls.
Generalmente por introduccion indebida de tabuladores o aplicar un mal formato al fichero de estado.

5.-Modificacion en la máquina Vagrant de origen
No aparece reflejado en el repositorio git, ya que se descarga esta imagen al ejecutar el aprovisionamiento Vagrant. He tenido que instalar un paquete RPM a mano python-psutil, ya que sin él, Vagrant fallaba en la ejecución del aprovisionamiento salt. Se producen varios mensajes en consola alusivos a la falta del paquete aludido, parece que lo necesita la función salt-call.
En principio no afecta al desarrollo del entorno, ya que Vagrant no "machaca" todas las veces la imagen Vagrant de ejecución, una vez se ha instalado por primera vez. Pero, es evidente que este tipo de detalles hay que tenerlos en cuenta -a priori- del desarrollo del entorno de aprovisionamiento salt, teniendo una "biblioteca" de cajas Vagrant que ya estén especialmente pre-adaptadas: por ejemplo, con la instalación adecuada de ciertos paquetes RPM e incluso repositorios que se sepa a priori que siempre se van a utilizar -EPEL- o incluso -mysql-community-, dejando el aprovisionamiento, quizás para configuraciones que puedan variar entre instalaciones.

{% if os_family == 'Arch' %}
# on arch linux: inital mysql datadirectory is not created
mysql_install_datadir:
  cmd.run:
    - name: mysql_install_db --user=mysql --basedir=/usr --datadir=/var/lib/mysql
    - user: root
    - creates: /var/lib/mysql/mysql/user.frm
    - require:
      - pkg: {{ mysql.server }} 
      - file: mysql_config
    - require_in:
      - service: mysqld
{% endif %}

mysqld-packages:
  pkg.installed:
    - name: {{ mysql.server }}
{% if os_family == 'Debian' and mysql_root_password %}
    - require:
      - debconf: mysql_debconf
{% endif %}

mysqld:
  service.running:
    - name: {{ mysql.service }}
    - enable: True
    - require:
      - pkg: {{ mysql.server }}
    - watch:
      - pkg: {{ mysql.server }}
      - file: mysql_config
{% if "config_directory" in mysql and "server_config" in mysql %}
      - file: mysql_server_config
{% endif %}

# official oracle mysql repo
# creates this file, that rewrites /etc/mysql/my.cnf setting
# so, make it empty
mysql_additional_config:
  file.managed:
    - name: /usr/my.cnf
    - source: salt://mysql/files/usr-my.cnf
    - create: False
    - watch_in:
      - service: mysqld
